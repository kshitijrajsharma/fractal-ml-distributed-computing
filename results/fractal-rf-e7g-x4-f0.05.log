Command: /opt/spark/work-dir/scripts/train.py --master spark://spark-master:7077 --data /opt/spark/work-dir/data/FRACTAL --num-executors 4 --fraction 0.05 --executor-cores 2 --executor-memory 7 --driver-memory 1 --enable-stage-metrics --output /opt/spark/work-dir/results
============================================================

2025-11-12 01:13:07 - INFO - Logging to: /opt/spark/spark-events/fractal-rf-e7g-x4-f0.05_20251112_011307.log
2025-11-12 01:13:07 - INFO - Starting single training run
2025-11-12 01:13:07 - INFO - Creating Spark session: fractal-rf-e7g-x4-f0.05
2025-11-12 01:13:07 - INFO - Spark master: spark://spark-master:7077
2025-11-12 01:13:07 - INFO - Stage metrics enabled
2025-11-12 01:13:08 - INFO - Spark session created successfully : executors=4, cores=2, memory=7g, fraction=0.05
2025-11-12 01:13:08 - INFO - Loading datasets
2025-11-12 01:13:08 - INFO - Loading data from /opt/spark/work-dir/data/FRACTAL/train/ with fraction=0.05
2025-11-12 01:13:16 - INFO - Loading 4000/80000 files (5.0%)
2025-11-12 01:13:23 - INFO - Loaded 248515837 rows, final partitions: 103
2025-11-12 01:13:23 - INFO - Loading data from /opt/spark/work-dir/data/FRACTAL/val/ with fraction=0.05
2025-11-12 01:13:24 - INFO - Loading 500/10000 files (5.0%)
2025-11-12 01:13:25 - INFO - Repartitioning from 13 to 24 partitions
2025-11-12 01:13:29 - INFO - Loaded 29591154 rows, final partitions: 24
2025-11-12 01:13:29 - INFO - Loading data from /opt/spark/work-dir/data/FRACTAL/test/ with fraction=0.05
2025-11-12 01:13:30 - INFO - Loading 500/10000 files (5.0%)
2025-11-12 01:13:31 - INFO - Repartitioning from 15 to 24 partitions
2025-11-12 01:13:35 - INFO - Loaded 40674645 rows, final partitions: 24
2025-11-12 01:13:37 - INFO - Train: 248515837, Val: 29591154, Test: 40674645, Partitions: 103
2025-11-12 01:13:37 - INFO - Training model
2025-11-12 01:24:56 - INFO - Training completed: 678.88s
2025-11-12 01:26:35 - INFO - Validation accuracy: 0.8052
2025-11-12 01:28:48 - INFO - Test accuracy: 0.7905
2025-11-12 01:28:48 - INFO - Total time: 940.88s
2025-11-12 01:28:48 - INFO - Results saved to /opt/spark/work-dir/results/fractal-rf-e7g-x4-f0.05.json
2025-11-12 01:28:49 - INFO - Spark session stopped
