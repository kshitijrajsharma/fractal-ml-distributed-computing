Command: /opt/spark/work-dir/scripts/train.py --master spark://spark-master:7077 --data /opt/spark/work-dir/data/FRACTAL --num-executors 2 --fraction 0.07 --executor-cores 2 --executor-memory 7 --driver-memory 1 --enable-stage-metrics --output /opt/spark/work-dir/results --event-log-dir /opt/spark/spark-events
============================================================

2025-11-13 12:42:57 - INFO - Logging to: /opt/spark/spark-events/fractal-rf-e7g-x2-f0.07_20251113_124257.log
2025-11-13 12:42:57 - INFO - Starting single training run
2025-11-13 12:42:57 - INFO - Creating Spark session: fractal-rf-e7g-x2-f0.07
2025-11-13 12:42:57 - INFO - Spark master: spark://spark-master:7077
2025-11-13 12:42:57 - INFO - Stage metrics enabled
2025-11-13 12:42:58 - INFO - Spark session created successfully : executors=2, cores=2, memory=7g, fraction=0.07
2025-11-13 12:42:58 - INFO - Loading datasets
2025-11-13 12:42:58 - INFO - Loading data from /opt/spark/work-dir/data/FRACTAL/train/ with fraction=0.07
2025-11-13 12:43:07 - INFO - Loading 5600/80000 files (7.0%)
2025-11-13 12:43:19 - INFO - Loaded 343594612 rows, partitions: 144
2025-11-13 12:43:19 - INFO - Loading data from /opt/spark/work-dir/data/FRACTAL/val/ with fraction=0.07
2025-11-13 12:43:20 - INFO - Loading 700/10000 files (7.0%)
2025-11-13 12:43:21 - INFO - Loaded 41677074 rows, partitions: 18
2025-11-13 12:43:21 - INFO - Loading data from /opt/spark/work-dir/data/FRACTAL/test/ with fraction=0.07
2025-11-13 12:43:23 - INFO - Loading 700/10000 files (7.0%)
2025-11-13 12:43:24 - INFO - Loaded 52920335 rows, partitions: 20
2025-11-13 12:43:25 - INFO - Train: 343594612, Val: 41677074, Test: 52920335, Partitions: 144, Rows/partition: 2386074
2025-11-13 12:43:25 - INFO - Training model
2025-11-13 13:29:34 - INFO - Training completed: 2768.71s
2025-11-13 13:33:11 - INFO - Validation accuracy: 0.8013
2025-11-13 13:37:32 - INFO - Test accuracy: 0.7925
2025-11-13 13:37:32 - INFO - Total time: 3274.02s
2025-11-13 13:37:32 - INFO - Results saved to /opt/spark/work-dir/results/fractal-rf-e7g-x2-f0.07.json
2025-11-13 13:37:32 - INFO - Spark session stopped
