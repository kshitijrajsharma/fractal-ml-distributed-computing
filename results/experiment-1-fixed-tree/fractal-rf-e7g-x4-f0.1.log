Command: /opt/spark/work-dir/scripts/train.py --master spark://spark-master:7077 --data /opt/spark/work-dir/data/FRACTAL --num-executors 4 --fraction 0.1 --executor-cores 2 --executor-memory 7 --driver-memory 1 --enable-stage-metrics --output /opt/spark/work-dir/results --event-log-dir /opt/spark/spark-events
============================================================

2025-11-13 10:09:36 - INFO - Logging to: /opt/spark/spark-events/fractal-rf-e7g-x4-f0.1_20251113_100936.log
2025-11-13 10:09:36 - INFO - Starting single training run
2025-11-13 10:09:36 - INFO - Creating Spark session: fractal-rf-e7g-x4-f0.1
2025-11-13 10:09:36 - INFO - Spark master: spark://spark-master:7077
2025-11-13 10:09:36 - INFO - Stage metrics enabled
2025-11-13 10:09:37 - INFO - Spark session created successfully : executors=4, cores=2, memory=7g, fraction=0.1
2025-11-13 10:09:37 - INFO - Loading datasets
2025-11-13 10:09:37 - INFO - Loading data from /opt/spark/work-dir/data/FRACTAL/train/ with fraction=0.1
2025-11-13 10:09:46 - INFO - Loading 8000/80000 files (10.0%)
2025-11-13 10:09:58 - INFO - Loaded 491467368 rows, partitions: 206
2025-11-13 10:09:58 - INFO - Loading data from /opt/spark/work-dir/data/FRACTAL/val/ with fraction=0.1
2025-11-13 10:09:59 - INFO - Loading 1000/10000 files (10.0%)
2025-11-13 10:10:00 - INFO - Loaded 61748129 rows, partitions: 26
2025-11-13 10:10:00 - INFO - Loading data from /opt/spark/work-dir/data/FRACTAL/test/ with fraction=0.1
2025-11-13 10:10:01 - INFO - Loading 1000/10000 files (10.0%)
2025-11-13 10:10:02 - INFO - Loaded 70983222 rows, partitions: 28
2025-11-13 10:10:04 - INFO - Train: 491467368, Val: 61748129, Test: 70983222, Partitions: 206, Rows/partition: 2385764
2025-11-13 10:10:04 - INFO - Training model
2025-11-13 10:44:16 - INFO - Training completed: 2052.03s
2025-11-13 10:48:50 - INFO - Validation accuracy: 0.7999
2025-11-13 10:53:46 - INFO - Test accuracy: 0.7875
2025-11-13 10:53:46 - INFO - Total time: 2649.15s
2025-11-13 10:53:46 - INFO - Results saved to /opt/spark/work-dir/results/fractal-rf-e7g-x4-f0.1.json
2025-11-13 10:53:46 - INFO - Spark session stopped
